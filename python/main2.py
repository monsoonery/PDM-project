import time
import matplotlib.pyplot as plt
import random
import numpy as np

import robot
import RRT_v3 as RRTstar
import environment

def print_time(name_step):
    t = time.localtime()
    current_time = time.strftime("%H:%M:%S", t)
    print(name_step, " : ", current_time)


if __name__ == "__main__":
     # Manipulator parameters
     l1 = 0.4
     l2 = 0.7
     l3 = 0.6

     # Start configuration and goal xyz-coordinates
     initial_config = [-9.5, -9.5, 0, 0, (1/2)*np.pi]
     goal = [9, 9, 1]

     # Create environment and robot object for simulation
     env = environment.Environment()
     coffeebot = robot.Robot(env.env, initial_config, l1, l2, l3)

     result = [[-5.076973159140427, -7.5809728412151465, 1.7465596588451004, 0.42626525330745335, -0.566189644732431], [-3.236726353092104, -7.177605578263373, 2.2217222586018064, 0.5194325629818755, 1.0483882158656979], [-1.9353467878569113, -5.893637318939488, 0.7675521520982812, 1.0933785080829321, -0.18967944297877004], [-1.3316409654400836, -4.1183170684714625, 4.2630548670321735, -0.0419944438295925, 0.7000832249357072], [-0.8484522795364793, -3.386230345648289, 1.1853378226410372, 0.6204596093083223, 0.30074525947311415], [0.134288529345147, 
-0.7084784803818263, 3.4828724799219346, 0.916772648075606, 1.6582447178668533], [0.9812917446021228, 2.1270188897898965, 0.5417078475668349, -0.599130880783964, 2.0926988263921866], [1.2878432259978467, 4.888372254893662, 1.102667064114589, 1.1188672414271807, 1.6631288314420511], [3.2325366809025233, 6.7969287936067, 2.0722175332533546, 0.608443791380096, -0.887111224338001], [4.821376383847683, 8.62666163044334, 1.8971816635143561, 0.700206113838092, -2.0464932110161236], [6.557948065238804, 9.016385440388454, 5.142327618867067, 0.3568009837743089, 0.5977368596816062], [9.388349549061484, 8.257073178813982, 0.43366008506856396, 1.3627461207235978, -1.9614643855015623]]
     # Follow the planned path in the simulation
     if result:
          print_time("Start Moving")
          for config in result:
               time.sleep(0.1)
               print(f"current config: {config}")
               coffeebot.move_to_goal(goal = config)
          print_time("Done Moving")

     time.sleep(10)
     env.close_simulation()
